<!doctype html>
<html lang="ja">

	<head>
		<meta charset="utf-8">

    <title>è‡ªä½œè¨€èªOnionã®å®Ÿè£…</title>

		<meta name="description" content="è‡ªä½œè¨€èªOnionã®å®Ÿè£…">
		<meta name="author" content="Kota Mizushima">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/black.css" id="theme">
<style type='text/css'>     
  .reveal h1,               
  .reveal h2,               
  .reveal h3,               
  .reveal h4,               
  .reveal h5,               
  .reveal h6 {              
    text-transform: none;   
  }                         
</style>                    

		<!-- Code syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

<!-- Any section element inside of this container is displayed as a slide -->
<div class='slides'>
<section data-markdown data-separator='^\n---$'><script type='text/template'>

## è‡ªä½œè¨€èªOnionã®å®Ÿè£…
## è¨€èªå®Ÿè£…å‹‰å¼·ä¼šï¼ˆ2018/11/17ï¼‰
## æ§‹æ–‡è§£æå‹ã®ä¼š æ°´å³¶å®å¤ª

---

### è‡ªå·±ç´¹ä»‹

- Twitter: [@kmizu](https://twitter.com/kmizu)
- GitHub: [kmizu](https://github.com/kmizu)
- å¥½ããªè¨€èª: Scala,Nemerle,Racket, etc.
- æ§‹æ–‡è§£æï¼ˆç”Ÿæˆç³»ï¼‰ãŒå¤§å¥½ã
- ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªä½œã‚ŠãŒè¶£å‘³
  - Onion <- Suspended
  - Klassic <- Active
- Japan Scala Associationä»£è¡¨ç†äº‹

---

### Onionã®æ¦‚è¦

- URL: https://github.com/onion-lang/onion
- è‡ªä½œã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã¨ãã®å‡¦ç†ç³»ï¼ˆon JVMï¼‰
- é™çš„å‹ä»˜ãã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘è¨€èª
- JVMã®ã‚¯ãƒ©ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‡ºåŠ›ã™ã‚‹
- from 2004ï¼ˆå­¦é¡ï¼ˆå­¦éƒ¨ï¼‰3å¹´ï¼‰ã€œ
  - æ•°å¹´å‰ã«å®Ÿè£…è¨€èªã‚’Javaã‹ã‚‰Scalaã«ç§»è¡Œ
- æœ€è¿‘ã¯ã»ã¼æ›´æ–°åœæ­¢
  - æ°—ãŒå‘ã„ãŸã‚‰æ‰‹ã‚’åŠ ãˆãŸã„

---

### è„±ç·š

- JVMè¨€èªã£ã¦ã„ã„æ–¹ã¯ã¡ã‚‡ã£ã¨å¤‰
- è¨€èªï¼ˆä»•æ§˜ï¼‰ã¨å‡¦ç†ç³»ï¼ˆå®Ÿè£…ï¼‰ã®è©±ãŒæ··ã–ã£ã¦ã‚‹

---

### Onionã®ç‰¹å¾´

- å½“æ™‚ã¨ã—ã¦ã¯ã€è»½é‡ãªé™çš„å‹ä»˜ã‘è¨€èª
- ã‚¹ã‚¯ãƒªãƒ—ãƒˆè¨€èªçš„ï¼ˆå¤ã„ï¼‰
  - ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«æ–‡
  - ä»£å…¥ã«ã‚ˆã‚‹å¤‰æ•°å®£è¨€
    - Rubyã«å½±éŸ¿ã•ã‚ŒãŸ
  - è‡ªå‹•ãƒ€ã‚¦ãƒ³ã‚­ãƒ£ã‚¹ãƒˆ
    - æ•°å¹´å‰ã«å‰Šé™¤
  - ã‚¯ãƒ©ã‚¹ç§»è­²

---

### Hello, Onion

- ã“ã®ä¸€è¡Œã§æ­£ã—ã„Onionãƒ—ãƒ­ã‚°ãƒ©ãƒ 
- ä»•æ§˜ã¨ã—ã¦ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ãŒã‚ã‚‹

```scala
System::out.println("Hello, World!");
```

---

### ä»£å…¥ã«ã‚ˆã‚‹å¤‰æ•°å®£è¨€

- æœªå®£è¨€ã®å¤‰æ•°ã¸ã®ä»£å…¥ãŒå®£è¨€ã¨ãªã‚‹
- å†ä»£å…¥ã¯æ™®é€šã®ä»£å…¥
- å‹ã¯åˆæœŸåŒ–å¼ã®å‹ã«ãªã‚‹
  - ã„ã‚ã‚†ã‚‹ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ•°å‹æ¨è«–
- æ˜ç¤ºçš„ãªå¤‰æ•°å®£è¨€ã‚‚ã§ãã‚‹

---

### ä»£å…¥ã«ã‚ˆã‚‹å¤‰æ•°å®£è¨€

```scala
frame = new JFrame(â€œFrameâ€);//frameã‚’å®£è¨€
pane = frame.getContentPane(); // paneã‚’å®£è¨€
pane.setLayout(new FlowLayout);
for i = 0; i < 9; i = i + 1 {// iã‚’å®£è¨€
  pane.add(new JButton("Button" + i));
}
frame.pack;
frame.setVisible(true);
```

---

### è‡ªå‹•ãƒ€ã‚¦ãƒ³ã‚­ãƒ£ã‚¹ãƒˆ

- ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚¿ã‚¤ãƒ—ã®å¼ã‚’ã‚µãƒ–ã‚¿ã‚¤ãƒ—ã«ä»£å…¥æ™‚ã«ã‚­ãƒ£ã‚¹ãƒˆã‚’è‡ªå‹•æŒ¿å…¥
- éäº’æ›ãªå‹ã¯å‹ã‚¨ãƒ©ãƒ¼
- ã‚¤ã‚±ã¦ãªã„ã®ã§æœ€çµ‚çš„ã«æ¶ˆã—ãŸ
  - Gradual Typingçš„ãªã‚‚ã®ã«é€²åŒ–ã§ããŸã‹ã‚‚

---

### è‡ªå‹•ãƒ€ã‚¦ãƒ³ã‚­ãƒ£ã‚¹ãƒˆ

```scala
xs = ["A", "B", "C"];
foreach x in xs {
  s: String = s; // è‡ªå‹•ãƒ€ã‚¦ãƒ³ã‚­ãƒ£ã‚¹ãƒˆ
  System::out.println(s);
}
```

---

### ã‚¯ãƒ©ã‚¹å§”è­²

- Kotlinã¨ã‹ã«ã‚ã‚‹
- ã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹ã®å®Ÿè£…ã‚’ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å§”è­²

---

### ã‚¯ãƒ©ã‚¹å§”è­²

```scala
clas AList <: List {
  forward @xs: List;
public:
  new { @xs = []; }
}

ys = new AList;
// ãƒ¡ã‚½ãƒƒãƒ‰ãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã¦ã„ã‚‹
ys.add("Foo");
ys.add("Bar");
```

---

### ç„¡åé–¢æ•°

- ä»Šã§ã¯ã™ã£ã‹ã‚ŠãŠé¦´æŸ“ã¿ã®æ©Ÿèƒ½
- ã„ã‚ã‚†ã‚‹ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£

---

### ç„¡åé–¢æ•°

```scala
add = #(a: Object, b: Object) { 
  return a$String + b$String; 
}
System::out.println(add.call("A", "B")); // AB
```

---

### Onionå‡¦ç†ç³»ã®æ¦‚è¦

- ç´„7000è¡Œã®Scalaãƒ—ãƒ­ã‚°ãƒ©ãƒ 
- JavaCCã«ã‚ˆã‚‹æ§‹æ–‡å®šç¾©
  - ç´„900è¡Œ
- Apache BCELã§ã‚¯ãƒ©ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆ
  - ä»Šæ›¸ãç›´ã™ãªã‚‰ASMã ã‚ã†

---

### Onionå‡¦ç†ç³»ã®ç‰¹å¾´

- ç‹¬è‡ªã®ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚’æŒãŸãªã„
  - javaã‚³ãƒãƒ³ãƒ‰ã§ï¼ˆãƒ©ãƒ³ã‚¿ã‚¤ãƒ jarãªã—ã«ï¼‰å‹•ã
  - é–‹ç™ºå½“æ™‚ã¯é…å¸ƒã‚µã‚¤ã‚ºã‚’é‡è¦–ã—ãŸãŸã‚
- ã‚¯ãƒ©ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’åã
  - å‰²ã¨javacã«è¿‘ã„ãƒ¬ãƒ™ãƒ«ã®ç´ æœ´ã•
- Scalaã§æ›¸ã‹ã‚Œã¦ã„ã‚‹

---

### Onionå‡¦ç†ç³»ã®å‡¦ç†ã®æµã‚Œ

1. å­—å¥è§£æï¼ˆJavaCCã‹ã‚‰ç”Ÿæˆï¼‰
2. æ§‹æ–‡è§£æï¼ˆJavaCCã‹ã‚‰ç”Ÿæˆï¼‰
3. ã‚¯ãƒ©ã‚¹åè¡¨ã®ä½œæˆ
4. ç¶™æ‰¿é–¢ä¿‚ã¨ãƒ¡ãƒ³ãƒã®å‹ã®è§£æ±º
5. å§”è­²ãƒ¡ã‚½ãƒƒãƒ‰ã®ç”Ÿæˆ
6. å‹ãƒã‚§ãƒƒã‚¯
7. ä¸­é–“è¡¨ç¾ã¸ã®å¤‰æ›
8. ä¸­é–“è¡¨ç¾ã‹ã‚‰ã‚³ãƒ¼ãƒ‰ç”Ÿæˆï¼ˆwith BCELï¼‰

---

### å½“æ™‚ã®è‹¦åŠ´ãƒã‚¤ãƒ³ãƒˆ

ä»Šãªã‚‰ãªã‚“ã¦ã“ã¨ã¯ãªã„

- ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã®å®Ÿè£…
- ãƒã‚¤ãƒˆã‚³ãƒ¼ãƒ‰ç”Ÿæˆ
- ç„¡åé–¢æ•°ï¼ˆã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£ï¼‰å®Ÿè£…

---

### ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã®å®Ÿè£… - Scala, Kotlin

- ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã«è©•ä¾¡å¯èƒ½ãªå¼ï¼ˆæ–‡ï¼‰ã¯æ›¸ã‘ãªã„
  - scalac/kotlincã‚³ãƒãƒ³ãƒ‰
- ç‰¹åˆ¥ãªã‚³ãƒãƒ³ãƒ‰ã§å®Ÿè¡Œã—ãŸå ´åˆã€å¤–å´ã‚’ã‚¯ãƒ©ã‚¹ã§ãƒ©ãƒƒãƒ—ã—ã¦ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«
  - scala/kotlinã‚³ãƒãƒ³ãƒ‰

---

### ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã®å®Ÿè£… - Onion

- ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«æ–‡ãŒå­˜åœ¨
  - ãã®ã¾ã¾å®Ÿè¡Œå¯èƒ½ï¼ˆonionã‚³ãƒãƒ³ãƒ‰ï¼‰
  - æ˜ç¤ºçš„ãªã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚‚å¯èƒ½ï¼ˆonioncã‚³ãƒãƒ³ãƒ‰ï¼‰
- ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã«å®£è¨€ï¼ˆã‚¯ãƒ©ã‚¹/ã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹ï¼‰ã‚‚æ›¸ã‘ã‚‹
- ä¸¡è€…ã‚’æ··ãœã‚‹ã“ã¨ã‚‚ã§ãã‚‹

---

### ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã®å®Ÿè£… - Onion

- å®£è¨€ã¨æ–‡ã®æ··åœ¨ã‚’ã©ã†å‡¦ç†ã™ã¹ãã‹

```scala
class A {
}
println(new A);
println(new B);
class B {
}
```

---

### ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã®å®Ÿè£… - Onion

ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«æ–‡

1. ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã‚’ç”Ÿæˆ
  - ã‚¯ãƒ©ã‚¹ï¼š ãƒ•ã‚¡ã‚¤ãƒ«å-æ‹¡å¼µå­+Main
    - e.g. `A.on` --> `AMain`
  - ãƒ¡ã‚½ãƒƒãƒ‰ï¼š `start(args: String[])`
2. ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«è¦ç´ ã®ãƒªã‚¹ãƒˆã‚’ãŸã©ã‚‹
3. ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«æ–‡ã®ãƒªã‚¹ãƒˆã‚’ä½œæˆ
4. ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã«ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«æ–‡ã®ãƒªã‚¹ãƒˆã‚’åŸ‹ã‚è¾¼ã‚€
5. mainãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”Ÿæˆ
  - ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ç”¨ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆ
  - startãƒ¡ã‚½ãƒƒãƒ‰ã®å‘¼ã³å‡ºã—

---

### ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã®å®Ÿè£… - Onion

ã‚¯ãƒ©ã‚¹ã¨ã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹

æ™®é€šã«å‡¦ç†

- ç›¸äº’ä¾å­˜é–¢ä¿‚è§£æ±º
- å¾ªç’°ç¶™æ‰¿æ¤œå‡º
- , etc.

---

### ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã®å®Ÿè£… - Onion

```scala
// Foo.on
class A {}
println(new A);
println(new B);
class B {}
```

â†“

```scala
class FooMain {
public:
  static main(args: String[]) {
    (new FooMain).start(args);
  }
  start(args: String) {
    println(new A);
    println(new B);
  }
}
class A {}
class B {}
```

---

### ãƒã‚¤ãƒˆã‚³ãƒ¼ãƒ‰ç”Ÿæˆ

- Javaãƒã‚¤ãƒˆã‚³ãƒ¼ãƒ‰ã¯é™çš„å‹ä»˜ãã‚¢ã‚»ãƒ³ãƒ–ãƒªè¨€èª
  - å‹å®£è¨€ã¨ã‹ã¯ãªã„
  - å‘½ä»¤ã«å‹ãŒåŸ‹ã‚è¾¼ã¾ã‚ŒãŸã‚Šã‚ªãƒšãƒ©ãƒ³ãƒ‰ã‚¹ã‚¿ãƒƒã‚¯ã‹ã‚‰æ¨è«–ã•ã‚ŒãŸã‚Š
- ã‚¯ãƒ©ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã¯å®Ÿè¡Œå‰ã«æ§˜ã€…ãªåˆ¶ç´„ã‚’æº€ãŸã—ã¦ã„ã‚‹ã“ã¨ã‚’ãƒã‚§ãƒƒã‚¯
  - ã‚ªãƒšãƒ©ãƒ³ãƒ‰ã‚¹ã‚¿ãƒƒã‚¯ãŒå£Šã‚Œã¦ã„ãªã„ã‹
  - å‹çš„ã«ãŠã‹ã—ãªå‘½ä»¤ãŒç™ºè¡Œã•ã‚Œã¦ã„ãªã„ã‹
  - ã‚ªãƒšãƒ©ãƒ³ãƒ‰ã‚¹ã‚¿ãƒƒã‚¯ãŒã‚ã‚‹PCã§**å¸¸ã«åŒã˜ã‚µã‚¤ã‚º**ã‹
  - æœªåˆæœŸåŒ–ã®ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ•°ãŒä½¿ã‚ã‚Œã¦ã„ãªã„ã‹
  - , etc.
- æ°—ã‚’ã¤ã‘ãªã„ã¨ãƒ™ãƒªãƒ•ã‚¡ã‚¤ã‚¢ã«ã¯ã­ã‚‰ã‚Œã‚‹ã‚¯ãƒ©ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã‚‹
  - ã—ã‹ã‚‚ã€ãƒ™ãƒªãƒ•ã‚¡ã‚¤ã‚¢ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ä¸è¦ªåˆ‡
- JVM Specã‚’å¸¸ã«æ‰‹å…ƒã«ç½®ãå¿…è¦ãŒâ€¦

---

### ãƒã‚¤ãƒˆã‚³ãƒ¼ãƒ‰ç”Ÿæˆ - ãƒ™ãƒªãƒ•ã‚¡ã‚¤ã‚¢ãŒã‚¨ãƒ©ãƒ¼ã‚’åãä¾‹

- PC 2ã€œ18ã¾ã§ï¼ˆãƒ«ãƒ¼ãƒ—æœ¬ä½“ï¼‰ã®å…¨ã¦ã®åœ°ç‚¹ã§ãƒ«ãƒ¼ãƒ—æ¯ã«ã‚ªãƒšãƒ©ãƒ³ãƒ‰ã‚¹ã‚¿ãƒƒã‚¯ã®ã‚µã‚¤ã‚ºãŒå¤‰ã‚ã‚‹
  - ã‚ã‚‹PCã«ãŠã‘ã‚‹ã‚ªãƒšãƒ©ãƒ³ãƒ‰ã‚¹ã‚¿ãƒƒã‚¯ã®ã‚µã‚¤ã‚ºã¯ä¸å¤‰ã§ãªã‘ã‚Œã°ã„ã‘ãªã„

```
       0: iconst_0
       1: istore_1
       2: iload_1
       3: bipush        10
       5: if_icmpge     21
       8: getstatic     #2   // Field java/lang/System.out:Ljava/io/PrintStream;
      11: iload_1
      12: invokevirtual #3   // Method java/io/PrintStream.println:(I)V
      15: iinc          1, 1
          bipush        0    // ãƒ«ãƒ¼ãƒ—æ¯ã«ã‚ªãƒšãƒ©ãƒ³ãƒ‰ã‚¹ã‚¿ãƒƒã‚¯ã«å€¤ã‚’ç©ã‚€            
      18: goto          2
      21: return
```

---

### ãƒã‚¤ãƒˆã‚³ãƒ¼ãƒ‰ç”Ÿæˆ - ä½œæˆéç¨‹ã§çŠ¯ã—ãŸãƒŸã‚¹ã®æ•°ã€…

- ã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹å‹ã«`invokevirtual`ã‚’ç™ºè¡Œ
- ã‚¯ãƒ©ã‚¹å‹ã«`invokeinterface`ã‚’ç™ºè¡Œ
- æ§˜ã€…ãªï¼ˆã‚ªãƒšãƒ©ãƒ³ãƒ‰ã‚¹ã‚¿ãƒƒã‚¯ä¸Šã®ï¼‰å‹ã‚¨ãƒ©ãƒ¼
- ã‚¹ã‚¿ãƒƒã‚¯ã‚µã‚¤ã‚º1ã®çŠ¶æ…‹ã§`pop2`ã‚’ç™ºè¡Œã—ã¦ã—ã¾ã†
- ä¸æ•´åˆãªã‚ªãƒšãƒ©ãƒ³ãƒ‰ã‚¹ã‚¿ãƒƒã‚¯ã®çŠ¶æ…‹ã‚’ä½œã£ã¦ã—ã¾ã†
  - ãƒ«ãƒ¼ãƒ—æ¯ã«å‹ãŒå¤‰ã‚ã£ã¦ãŸã‚Š
- `checkcast`ã®ç™ºè¡Œã—å¿˜ã‚Œ
  - ã‚ªãƒšãƒ©ãƒ³ãƒ‰ã‚¹ã‚¿ãƒƒã‚¯ã®ãƒˆãƒƒãƒ—ã®å‹ãŒãŠã‹ã—ããªã‚‹
- , etc.

---

### ç„¡åé–¢æ•°ï¼ˆã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£ï¼‰å®Ÿè£…

- ã‚­ãƒ£ãƒ—ãƒãƒ£ã•ã‚Œã‚‹è‡ªç”±å¤‰æ•°ã®å–æ‰±ã„ä»¥å¤–ã¯ç°¡å˜
  - å˜ã«ç‰¹å®šã®ã‚¯ãƒ©ã‚¹ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›ã™ã‚Œã°ã„ã„
- è‡ªç”±å¤‰æ•°ã‚’ã©ã†æ‰±ã†ã‹
  - JVMã§ã¯ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ•°ã¯ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æŠœã‘ã‚‹ã¨æ¶ˆãˆã‚‹
  - ãƒ’ãƒ¼ãƒ—ã«ç¢ºä¿ã™ã‚‹å¿…è¦æ€§
  - å˜ç´”ã«ã¯ã€`class VarRef[A](var value: A)` ã¿ãŸã„ãªã®ä½œã‚Œã°ã„ã„
- Onionã®æ–¹é‡ä¸Šã®åˆ¶ç´„
  - Ã—ç‹¬è‡ªã®ã‚¯ãƒ©ã‚¹ã‚’ä½¿ã†ï¼ˆãƒ©ãƒ³ã‚¿ã‚¤ãƒ ãƒ•ãƒªãƒ¼ã«ã™ã‚‹ãŸã‚ï¼‰
  - ğŸ’¡ãã†ã ã€é…åˆ—ï¼ˆ`Object[]`ï¼‰ã‚’ä½¿ãŠã†ï¼

---

### ç„¡åé–¢æ•°ï¼ˆã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£ï¼‰å®Ÿè£…

```scala
interface C { def call(): void; }
def f(x: Int, y: Int): void {
  c = #C.call { x = x + 1; y = y + 1; };
  c.call;
  System::out.println(x + y);
}
f(0, 0); // 2
```

---

### ç„¡åé–¢æ•°ï¼ˆã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£ï¼‰å®Ÿè£…

```java
interface C { void call(); }

class AnonymousFunctionMain {
  public void f(int x, int y) {
    Object[] frame0 = new Object[3];
    frame0[0] = x;
    frame0[1] = y;
    frame0[2] = new AnonymousFunctionMainClosure0(this, frame0);
    ((AnonymousFunctionMainClosure0)frame0[2]).call();
    System.out.println(
      ((Integer)frame0[0]).intValue() + 
      ((Integer)frame0[1]).intValue()
    );
  }
  public void start(String[] args) {
    f(0, 0);
  }
  public static void main(String[] args) {
    new AnonymousFunctionMain().start();
  }
}

class AnonymousFunctionMainClosure0 {
  private Object outer$;
  private Object[] frame1;

  AnonymousFunctionMainClosure0(Object o, Object[] f) {
    outer$ = o;
    frame1 = f;
  }
  public void call() {
    frame1[0] = ((Integer)frame1[0]).intValue() + 1;
    frame1[1] = ((Integer)frame1[1]).intValue() + 1;
    return;
  }
}
```

---

### Onionã®å‡¦ç†ç³»å®Ÿè£…ã§å¾—ã‚‰ã‚ŒãŸã‚‚ã®ï¼ˆã†ã‚è¦šãˆï¼‰

- ã‚¯ãƒ©ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«é–¢é€£ã®çŸ¥è­˜
  - ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
  - ãƒ™ãƒªãƒ•ã‚¡ã‚¤ã‚¢
  - ãƒã‚¤ãƒˆã‚³ãƒ¼ãƒ‰
- å‰²ã¨å¤§ããªè¨€èªã®å®Ÿè£…ã‚’ã™ã‚‹ã®ã«å¿…è¦ãªçŸ¥è­˜
- ãã®ä»–è‰²ã€…

---

### Onionã®ä»Šå¾Œ

- ç¾åœ¨ã¯é–‹ç™ºåœæ­¢ä¸­
- æ°—ãŒå‘ã„ãŸã‚‰ä»Šé¢¨ã®ä»•æ§˜ã«ç›´ã—ãŸã„
  - ã‚»ãƒŸã‚³ãƒ­ãƒ³çœç•¥
  - æ–‡ã§ã¯ãªãå¼
  - ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹å°å…¥
- æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®æ•´å‚™


---

</script></section>

      </div>
		</div>
    

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>

			// Full list of configuration options available at:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// Optional reveal.js plugins
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});

		</script>

	</body>
</html>
